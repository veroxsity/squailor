# Storage Architecture Diagram

## Portable Version - Storage Structure

```
ğŸ“ Any Folder (Desktop, USB Drive, etc.)
â”‚
â”œâ”€â”€ ğŸ“¦ Squailor-1.0.0-Portable.exe    â† Single executable file
â”‚
â””â”€â”€ ğŸ“ data/                           â† Auto-created on first run
    â”‚
    â”œâ”€â”€ ğŸ“ documents/                  â† Stores all processed documents
    â”‚   â”‚
    â”‚   â”œâ”€â”€ ğŸ“ abc12345/               â† Unique folder per document
    â”‚   â”‚   â”œâ”€â”€ ğŸ“„ MyPresentation.pptx â† Original file
    â”‚   â”‚   â””â”€â”€ ğŸ“„ summary.json        â† Summary + metadata
    â”‚   â”‚
    â”‚   â”œâ”€â”€ ğŸ“ xyz67890/
    â”‚   â”‚   â”œâ”€â”€ ğŸ“„ Report.pdf
    â”‚   â”‚   â””â”€â”€ ğŸ“„ summary.json
    â”‚   â”‚
    â”‚   â””â”€â”€ ğŸ“ [more documents...]
    â”‚
    â”œâ”€â”€ ğŸ“„ settings.json               â† User preferences
    â”‚                                     {
    â”‚                                       "storageLocation": "local-app",
    â”‚                                       "theme": "dark",
    â”‚                                       "aiModel": "gpt-4o-mini"
    â”‚                                     }
    â”‚
    â””â”€â”€ ğŸ”’ keystore.enc                â† Encrypted API key
```

## Installable Version - Storage Structure

```
ğŸ“ C:\Users\YourName\AppData\Roaming\Squailor\
â”‚
â””â”€â”€ ğŸ“ data/
    â”‚
    â”œâ”€â”€ ğŸ“ documents/                  â† Same structure as portable
    â”‚   â”œâ”€â”€ ğŸ“ abc12345/
    â”‚   â”œâ”€â”€ ğŸ“ xyz67890/
    â”‚   â””â”€â”€ ...
    â”‚
    â”œâ”€â”€ ğŸ“„ settings.json
    â”‚       {
    â”‚         "storageLocation": "appdata",
    â”‚         "theme": "dark",
    â”‚         "aiModel": "gpt-4o-mini"
    â”‚       }
    â”‚
    â””â”€â”€ ğŸ”’ keystore.enc
```

## Storage Location Detection Flow

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚     App Starts                          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
               â”‚
               â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Check: Does "data" folder exist        â”‚
â”‚  in executable directory?               â”‚
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
       â”‚ YES              â”‚ NO
       â–¼                  â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Use Local    â”‚   â”‚ Check: Does "data"   â”‚
â”‚ App Mode     â”‚   â”‚ exist in AppData?    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                          â”‚
                   â”Œâ”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”
                   â”‚ YES           â”‚ NO
                   â–¼               â–¼
            â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
            â”‚ Use      â”‚   â”‚ Create in      â”‚
            â”‚ AppData  â”‚   â”‚ AppData        â”‚
            â”‚ Mode     â”‚   â”‚ (default)      â”‚
            â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## Storage Migration Flow

```
User Switches Storage Location in Settings
                   â”‚
                   â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Determine Source and Target Locations   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
               â”‚
               â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  1. Create target "data" folder          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
               â”‚
               â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  2. Copy all documents/ folders          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
               â”‚
               â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  3. Copy settings.json                   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
               â”‚
               â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  4. Copy keystore.enc (API key)          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
               â”‚
               â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  5. Delete old files                     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
               â”‚
               â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  6. Update settings with new location    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
               â”‚
               â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  âœ… Migration Complete                   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## Document Storage Structure (Individual Document)

```
ğŸ“ documents/abc12345/
â”‚
â”œâ”€â”€ ğŸ“„ MyPresentation.pptx         â† Original file (preserved)
â”‚
â””â”€â”€ ğŸ“„ summary.json                â† Metadata + Summary
        {
          "fileName": "MyPresentation.pptx",
          "fileType": ".pptx",
          "fileHash": "sha256:...",        â† For duplicate detection
          "summary": "This presentation...",
          "originalLength": 15420,
          "summaryLength": 850,
          "summaryType": "normal",
          "responseTone": "casual",
          "timestamp": "2025-02-10T16:23:45.123Z",
          "model": "gpt-4o-mini",
          "preview": "First 500 chars..."
        }
```

## Comparison: Portable vs Installable

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                   PORTABLE VERSION                             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                â”‚
â”‚  ğŸ“¦ Squailor-1.0.0-Portable.exe                               â”‚
â”‚  ğŸ“ data/                                                     â”‚
â”‚     â”œâ”€â”€ documents/                                            â”‚
â”‚     â”œâ”€â”€ settings.json                                         â”‚
â”‚     â””â”€â”€ keystore.enc                                          â”‚
â”‚                                                                â”‚
â”‚  âœ“ Self-contained                                             â”‚
â”‚  âœ“ Can be moved anywhere                                      â”‚
â”‚  âœ“ Perfect for USB drives                                     â”‚
â”‚  âœ“ No installation                                            â”‚
â”‚  âœ“ No registry entries                                        â”‚
â”‚                                                                â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                  INSTALLABLE VERSION                           â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                â”‚
â”‚  ğŸ“ C:\Program Files\Squailor\                                â”‚
â”‚     â””â”€â”€ [App Files]                                           â”‚
â”‚                                                                â”‚
â”‚  ğŸ“ C:\Users\Name\AppData\Roaming\Squailor\                   â”‚
â”‚     â””â”€â”€ data/                                                 â”‚
â”‚         â”œâ”€â”€ documents/                                        â”‚
â”‚         â”œâ”€â”€ settings.json                                     â”‚
â”‚         â””â”€â”€ keystore.enc                                      â”‚
â”‚                                                                â”‚
â”‚  ğŸ“ Start Menu\                                               â”‚
â”‚     â””â”€â”€ Squailor.lnk                                          â”‚
â”‚                                                                â”‚
â”‚  ğŸ“ Desktop\                                                  â”‚
â”‚     â””â”€â”€ Squailor.lnk                                          â”‚
â”‚                                                                â”‚
â”‚  âœ“ Professional installation                                  â”‚
â”‚  âœ“ Start Menu integration                                     â”‚
â”‚  âœ“ Desktop shortcut                                           â”‚
â”‚  âœ“ Uninstaller included                                       â”‚
â”‚  âœ“ Follows Windows conventions                                â”‚
â”‚                                                                â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## Path Examples

### Portable - Executable Directory
```
E:\MyApps\Squailor-1.0.0-Portable.exe
E:\MyApps\data\documents\abc12345\...
```

### Portable - USB Drive
```
F:\PortableApps\Squailor-1.0.0-Portable.exe
F:\PortableApps\data\documents\abc12345\...
```

### Installable - AppData (Default)
```
C:\Program Files\Squailor\Squailor.exe
C:\Users\John\AppData\Roaming\Squailor\data\documents\abc12345\...
```

### Installable - Switched to Local
```
C:\Program Files\Squailor\Squailor.exe
C:\Program Files\Squailor\data\documents\abc12345\...
```

## Security Considerations

```
ğŸ“„ settings.json         â†’ Plain text (contains preferences)
ğŸ”’ keystore.enc          â†’ Encrypted (contains API key)
ğŸ“„ documents/*/summary.json â†’ Plain text (contains summaries)
ğŸ“¦ documents/*/*.pptx    â†’ Original format (user files)
```

**Encryption Details:**
- API keys encrypted using built-in encryption module
- Encryption keys derived from machine-specific identifiers
- Keys cannot be transferred between machines
- Re-enter API key if moving to new computer
